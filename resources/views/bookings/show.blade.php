@extends('layouts.app')
{{-- *** ุจุฏุงูุฉ ุงูููุฏ ุงูุฌุฏูุฏ: ุชุญุฏูุฏ ุนููุงู ุงูุตูุญุฉ *** --}}
@section('title', 'ุชูุงุตูู ุญุฌุฒ : ' . $booking->client_name)
{{-- *** ููุงูุฉ ุงูููุฏ ุงูุฌุฏูุฏ *** --}}

<head>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <link rel="icon" type="image/svg+xml" href="{{ asset('icons/booking-details.svg') }}">
</head>

@section('content')
    @php
        $total_nights = \Carbon\Carbon::parse($booking->check_in)->diffInDays(
            \Carbon\Carbon::parse($booking->check_out),
        );
        $editLogs = \App\Models\EditLog::where('booking_id', $id)->orderBy('created_at', 'desc')->get();
    @endphp
    <div class="container">
        <div class="row align-items-center mb-3">
            <div class="col-12 col-lg-7 mb-2 mb-lg-0">
                <h1 class="h4 mb-0 text-center text-lg-start">ุชูุงุตูู ุงูุญุฌุฒ ููุนููู: {{ $booking->client_name }}
                    <br>
                    <a href="{{ route('bookings.voucher', $booking->id) }}" class="btn btn-warning btn-sm" target="_blank">
                        ุนุฑุถ ุงููุงูุชุดุฑ
                    </a>
                </h1>
            </div>
            <div class="col-12 col-lg-5 d-flex justify-content-center justify-content-lg-end gap-2">
                <a href="{{ route('bookings.index') }}" class="btn btn-secondary">ุฑุฌูุน โก</a>
                <button id="copyBookingDetails" class="btn btn-primary">๐ ูุณุฎ ุจูุงูุงุช ุงูุญุฌุฒ ๐</button>
                <button id="calculate-total" class="btn btn-info">๐ ุงูุงุฌูุงูู ๐</button>

            </div>
        </div>
        <table class="table  table-hover table-bordered text-center">
            <thead>
                <tr>
                    <th>#</th>
                    <th>ุงูุนููุงู</th>
                    <th>ุงููููุฉ</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>ุงุณู ุงูุดุฑูุฉ <i class="fas fa-building text-primary"></i></td>
                    <td>{{ $booking->company->name ?? 'ุบูุฑ ูุญุฏุฏ' }}</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>ุฌูุฉ ุงูุญุฌุฒ <i class="fas fa-user-tie text-success"></i></td>
                    <td>{{ $booking->agent->name ?? 'ุบูุฑ ูุญุฏุฏ' }}</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>ุงุณู ุงูููุฏู <i class="fas fa-hotel text-info"></i></td>
                    <td>{{ $booking->hotel->name ?? 'ุบูุฑ ูุญุฏุฏ' }}</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>ููุน ุงูุบุฑูุฉ <i class="fas fa-bed text-warning"></i></td>
                    <td>{{ $booking->room_type }}</td>
                </tr>
                <tr>
                    <td>5</td>
                    <td>ุนุฏุฏ ุงูุบุฑู <i class="fas fa-door-open text-danger"></i></td>
                    <td>{{ $booking->rooms }}</td>
                </tr>
                <tr>
                    <td>6</td>
                    <td>ุชุงุฑูุฎ ุงูุฏุฎูู <i class="fas fa-calendar-check text-primary"></i></td>
                    <td>{{ $booking->check_in->format('d/m/Y') }}</td>
                </tr>
                <tr>
                    <td>7</td>
                    <td>ุชุงุฑูุฎ ุงูุฎุฑูุฌ <i class="fas fa-calendar-times text-danger"></i></td>
                    <td>{{ $booking->check_out->format('d/m/Y') }}</td>
                </tr>
                <tr>
                    <td>8</td>
                    <td>ุนุฏุฏ ุงูููุงูู <i class="fas fa-moon text-warning"></i></td>
                    <td>{{ $total_nights }} ูููุฉ</td>
                </tr>
                <tr>
                    <td>9</td>
                    <td>ุงูุฃูุงู ุงููุชุจููุฉ ุญุชู ุงูุฎุฑูุฌ <i class="fas fa-clock text-info"></i></td>
                    <td>
                        @php
                            // ูุถุจุท ููุช ููุง ุงูุชุงุฑูุฎูู ูุจุฏุงูุฉ ุงูููู (00:00:00)
                            $today = \Carbon\Carbon::now()->startOfDay();
                            $checkoutDate = \Carbon\Carbon::parse($booking->check_out)->startOfDay();
                            // ูุญุณุจ ุงููุฑู ุจุงูุฃูุงู ุงูุตุญูุญุฉ (ูุน ุชุฌุงูู ุงูุฅุดุงุฑุฉ ุงูุณุงูุจุฉ ูู ุงูุชุงุฑูุฎ ูุงุช)
                        $remaining_days = $today->diffInDays($checkoutDate, false); @endphp
                        {{ $remaining_days > 0 ? intval($remaining_days) . ' ููู' : 'ุงูุชูู ุงูุญุฌุฒ' }}
                    </td>

                </tr>
                <tr>
                    <td>10</td>
                    <td> ุงูุณุนุฑ ูู ุงูููุฏู <i class="fas fa-money-bill-wave text-success"></i></td>
                    <td>{{ $booking->cost_price }} {{ $booking->currency === 'SAR' ? 'ุฑูุงู ุณุนูุฏู' : 'ุฏููุงุฑ ูููุชู' }}</td>
                </tr>
                <!-- ุตู ุงููุณุชุญู ููููุฏู ุงููุญุณูุจ ุฏููุงููููุงู -->
                <tr id="hotel-due-row">
                    <td>11</td>
                    <td>ุงููุณุชุญู ููููุฏู <i class="fas fa-hand-holding-usd text-info"></i></td>
                    <td id="hotel-due-value">{{ $total_nights * $booking->rooms * $booking->cost_price }} {{ $booking->currency === 'SAR' ? 'ุฑูุงู ุณุนูุฏู' : 'ุฏููุงุฑ ูููุชู' }}</td>
                </tr>
                <tr>
                    <td>12</td>
                    <td> ุงููุจูุบ ุงููุฏููุน ููููุฏู <i class="fas fa-money-check-alt text-primary"></i></td>
                    <td>{{ $booking->amount_paid_to_hotel }} {{ $booking->currency === 'SAR' ? 'ุฑูุงู ุณุนูุฏู' : 'ุฏููุงุฑ ูููุชู' }}</td>
                </tr>
                <tr>
                    <td>13</td>
                    <td> ุงูุจุงูู ููููุฏู <i class="fas fa-money-check text-danger"></i></td>
                    <td>{{ $booking->amount_due_to_hotel - $booking->amount_paid_to_hotel }} {{ $booking->currency === 'SAR' ? 'ุฑูุงู ุณุนูุฏู' : 'ุฏููุงุฑ ูููุชู' }}</td>
                </tr>
                <tr>
                    <td>14</td>
                    <td> ุณุนุฑ ุงูุจูุน ููุดุฑูุฉ <i class="fas fa-tag text-warning"></i> </td>
                    <td>{{ $booking->sale_price }}  {{ $booking->currency === 'SAR' ? 'ุฑูุงู ุณุนูุฏู' : 'ุฏููุงุฑ ูููุชู' }}</td>
                </tr>
                <tr>
                    <td>15</td>
                    <td>ุงููุจูุบ ุงููุณุชุญู ูู ุงูุดุฑูุฉ <i class="fas fa-hand-holding-usd text-success"></i> </td>
                    <td>{{ number_format($booking->amount_due_from_company, 2) }}
                    {{ $booking->currency === 'SAR' ? 'ุฑูุงู ุณุนูุฏู' : 'ุฏููุงุฑ ูููุชู' }}
                    </td>
                </tr>
                <tr>
                    <td>16</td>
                    <td> ุงููุจูุบ ุงููุฏููุน ูู ุงูุดุฑูุฉ<i class="fas fa-wallet text-info"></i> </td>
                    <td>{{ number_format($booking->amount_paid_by_company, 2) }}
                        {{ $booking->currency === 'SAR' ? 'ุฑูุงู ุณุนูุฏู' : 'ุฏููุงุฑ ูููุชู' }} </td>
                </tr>
                <tr>
                    <td>17</td>
                    <td>ุงูุจุงูู ูู ุงูุดุฑูุฉ <i class="fas fa-balance-scale text-danger"></i> </td>
                    <td>{{ number_format($booking->amount_due_from_company - $booking->amount_paid_by_company, 2) }}
                        {{ $booking->currency === 'SAR' ? 'ุฑูุงู ุณุนูุฏู' : 'ุฏููุงุฑ ูููุชู' }} </td>
                </tr>
                <tr>
                    <td>18</td>
                    <td> ุงูููุธู ุงููุณุคูู <i class="fas fa-user text-primary"></i> </td>
                    <td>{{ $booking->employee->name ?? 'ุบูุฑ ูุญุฏุฏ' }}</td>
                </tr>
                <tr>
                    <td>19</td>
                    <td> ุงูููุงุญุธุงุช <i class="fas fa-sticky-note text-warning"></i> </td>
                    <td>{{ $booking->notes }}</td>
                </tr>
            </tbody>
        </table>

        <h3>ุณุฌู ุงูุชุนุฏููุงุช</h3>
        @if ($editLogs->isEmpty())
            <p>ูุง ุชูุฌุฏ ุชุนุฏููุงุช ูุณุฌูุฉ ููุฐุง ุงูุญุฌุฒ.</p>
        @else
            @php
                $fieldNames = [
                    'id' => '#',
                    'client_name' => 'ุงุณู ุงูุนููู',
                    'company_id' => 'ุงูุดุฑูุฉ',
                    'agent_id' => 'ุฌูุฉ ุงูุญุฌุฒ',
                    'hotel_id' => 'ุงูููุฏู',
                    'room_type' => 'ููุน ุงูุบุฑูุฉ',
                    'check_in' => 'ุชุงุฑูุฎ ุงูุฏุฎูู',
                    'check_out' => 'ุชุงุฑูุฎ ุงูุฎุฑูุฌ',
                    'days' => 'ุนุฏุฏ ุงูุฃูุงู',
                    'rooms' => 'ุนุฏุฏ ุงูุบุฑู',
                    'cost_price' => 'ุณุนุฑ ุงูููุฏู',
                    'amount_due_to_hotel' => 'ุงููุจูุบ ุงููุณุชุญู ููููุฏู',
                    'amount_paid_to_hotel' => 'ุงููุฏููุน ููููุฏู',
                    'sale_price' => 'ุณุนุฑ ุงูุจูุน',
                    'employee_id' => 'ุงูููุธู ุงููุณุคูู',
                    'amount_due_from_company' => 'ุงููุจูุบ ุงููุณุชุญู ูู ุงูุดุฑูุฉ',
                    'amount_paid_by_company' => 'ุงููุฏููุน ูู ุงูุดุฑูุฉ',
                    'payment_status' => 'ุญุงูุฉ ุงูุณุฏุงุฏ',
                    'notes' => 'ุงูููุงุญุธุงุช',
                    'created_at' => 'ุชุงุฑูุฎ ุงูุฅูุดุงุก',
                    'updated_at' => 'ุขุฎุฑ ุชุนุฏูู',
                ];
            @endphp
            <table class="table  table-hover table-bordered text-center ">
                <thead>
                    <tr>
                        <th>ุงูุญูู ุงููุนุฏู</th>
                        <th>ุงููููุฉ ุงููุฏููุฉ</th>
                        <th>ุงููููุฉ ุงูุฌุฏูุฏุฉ</th>
                        <th>ุชุงุฑูุฎ ุงูุชุนุฏูู</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach ($editLogs as $log)
                        @if (trim($log->old_value) !== trim($log->new_value))
                            <!-- ุชุฌุงูู ุงูุญููู ุบูุฑ ุงููุนุฏูุฉ -->
                            <tr>
                                <!-- ุนุฑุถ ุงุณู ุงูุญูู ุงููุนุฏู -->
                                <td>{{ $fieldNames[$log->field] ?? $log->field }}</td>

                                <!-- ุนุฑุถ ุงููููุฉ ุงููุฏููุฉ -->
                                <td>
                                    @if ($log->field === 'employee_id')
                                        <!-- ุฅุฐุง ูุงู ุงูุญูู ูู ุงูููุธู ุงููุณุคููุ ุฌูุจ ุงุณู ุงูููุธู ุจุฏูุงู ูู ุงูู ID -->
                                        {{ \App\Models\Employee::find($log->old_value)?->name ?? $log->old_value }}
                                    @elseif ($log->field === 'company_id')
                                        <!-- ุฅุฐุง ูุงู ุงูุญูู ูู ุงูุดุฑูุฉุ ุฌูุจ ุงุณู ุงูุดุฑูุฉ ุจุฏูุงู ูู ุงูู ID -->
                                        {{ \App\Models\Company::find($log->old_value)?->name ?? $log->old_value }}
                                    @elseif ($log->field === 'hotel_id')
                                        <!-- ุฅุฐุง ูุงู ุงูุญูู ูู ุงูููุฏูุ ุฌูุจ ุงุณู ุงูููุฏู ุจุฏูุงู ูู ุงูู ID -->
                                        {{ \App\Models\Hotel::find($log->old_value)?->name ?? $log->old_value }}
                                    @elseif ($log->field === 'agent_id')
                                        <!-- ุฅุฐุง ูุงู ุงูุญูู ูู ุฌูุฉ ุงูุญุฌุฒุ ุฌูุจ ุงุณู ุฌูุฉ ุงูุญุฌุฒ ุจุฏูุงู ูู ุงูู ID -->
                                        {{ \App\Models\Agent::find($log->old_value)?->name ?? $log->old_value }}
                                    @elseif (in_array($log->field, ['check_in', 'check_out']))
                                        <!-- ุฅุฐุง ูุงู ุงูุญูู ูู ุชุงุฑูุฎุ ุชูุณูู ุงูุชุงุฑูุฎ ูุนุฑุถู ุจุดูู ููุงุณุจ -->
                                        {{ $log->old_value ? \Carbon\Carbon::parse($log->old_value)->format('d/m/Y') : 'ุบูุฑ ูุญุฏุฏ' }}
                                    @else
                                        <!-- ุนุฑุถ ุงููููุฉ ุงููุฏููุฉ ููุง ูู ุฅุฐุง ูู ุชูู ูู ุงูุญููู ุงูุฎุงุตุฉ -->
                                        {{ $log->old_value ?: 'ุบูุฑ ูุญุฏุฏ' }}
                                    @endif
                                </td>

                                <!-- ุนุฑุถ ุงููููุฉ ุงูุฌุฏูุฏุฉ -->
                                <td>
                                    @if ($log->field === 'employee_id')
                                        <!-- ุฅุฐุง ูุงู ุงูุญูู ูู ุงูููุธู ุงููุณุคููุ ุฌูุจ ุงุณู ุงูููุธู ุงูุฌุฏูุฏ ุจุฏูุงู ูู ุงูู ID -->
                                        {{ \App\Models\Employee::find($log->new_value)?->name ?? $log->new_value }}
                                    @elseif ($log->field === 'company_id')
                                        <!-- ุฅุฐุง ูุงู ุงูุญูู ูู ุงูุดุฑูุฉุ ุฌูุจ ุงุณู ุงูุดุฑูุฉ ุงูุฌุฏูุฏ ุจุฏูุงู ูู ุงูู ID -->
                                        {{ \App\Models\Company::find($log->new_value)?->name ?? $log->new_value }}
                                    @elseif ($log->field === 'hotel_id')
                                        <!-- ุฅุฐุง ูุงู ุงูุญูู ูู ุงูููุฏูุ ุฌูุจ ุงุณู ุงูููุฏู ุงูุฌุฏูุฏ ุจุฏูุงู ูู ุงูู ID -->
                                        {{ \App\Models\Hotel::find($log->new_value)?->name ?? $log->new_value }}
                                    @elseif ($log->field === 'agent_id')
                                        <!-- ุฅุฐุง ูุงู ุงูุญูู ูู ุฌูุฉ ุงูุญุฌุฒุ ุฌูุจ ุงุณู ุฌูุฉ ุงูุญุฌุฒ ุงูุฌุฏูุฏ ุจุฏูุงู ูู ุงูู ID -->
                                        {{ \App\Models\Agent::find($log->new_value)?->name ?? $log->new_value }}
                                    @elseif (in_array($log->field, ['check_in', 'check_out']))
                                        <!-- ุฅุฐุง ูุงู ุงูุญูู ูู ุชุงุฑูุฎุ ุชูุณูู ุงูุชุงุฑูุฎ ุงูุฌุฏูุฏ ูุนุฑุถู ุจุดูู ููุงุณุจ -->
                                        {{ $log->new_value ? \Carbon\Carbon::parse($log->new_value)->format('d/m/Y') : 'ุบูุฑ ูุญุฏุฏ' }}
                                    @else
                                        <!-- ุนุฑุถ ุงููููุฉ ุงูุฌุฏูุฏุฉ ููุง ูู ุฅุฐุง ูู ุชูู ูู ุงูุญููู ุงูุฎุงุตุฉ -->
                                        {{ $log->new_value !== null && $log->new_value !== '' ? $log->new_value : 'ุบูุฑ ูุญุฏุฏ' }}
                                    @endif
                                </td>

                                <!-- ุนุฑุถ ุชุงุฑูุฎ ุงูุชุนุฏูู -->
                                <td>{{ \Carbon\Carbon::parse($log->created_at)->format('d/m/Y H:i') }}</td>
                            </tr>
                        @endif
                    @endforeach
                </tbody>
            </table>
        @endif
        {{-- <ul id="editLog"></ul>
    <pre>{{ print_r($editLogs->toArray()) }}</pre> --}}
    </div>



    <style>
        body {
            background-color: #121212;
            color: #ffffff;
        }

        .table {
            border-color: #444;
        }

        .table th,
        .table td {
            vertical-align: middle;
        }

        .table-hover tbody tr:hover {
            background-color: #333;
        }

        .copyable {
            cursor: pointer;
            color: #00bcd4;
        }

        .copyable:hover {
            text-decoration: underline;
        }

        .alert {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 9999;
            /* ูุถูุงู ุธููุฑู ููู ุฌููุน ุงูุนูุงุตุฑ */
            padding: 15px;
            border: 1px solid transparent;
            border-radius: 4px;
            font-size: 16px;
            font-weight: bold;
            text-align: center;
            width: 90%;
            /* ุนุฑุถ ุงูุชูุจูู */
            max-width: 500px;
            /* ุงูุญุฏ ุงูุฃูุตู ููุนุฑุถ */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .alert-success {
            color: #155724;
            background-color: #d4edda;
            border-color: #c3e6cb;
        }

        .alert-danger {
            color: #721c24;
            background-color: #f8d7da;
            border-color: #f5c6cb;
        }

        .alert-info {
            color: #0c5460;
            background-color: #d1ecf1;
            border-color: #bee5eb;
        }

        .alert-warning {
            color: #856404;
            background-color: #fff3cd;
            border-color: #ffeeba;
        }

        .d-flex {
            display: flex;
        }

        .justify-content-between {
            justify-content: space-between;
        }

        .align-items-center {
            align-items: center;
        }

        .mb-3 {
            margin-bottom: 1rem;
        }

        .btn {
            margin-left: 5px;
        }
    </style>



    <script src="{{ asset('js/preventClick.js') }}"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const copyButton = document.getElementById('copyBookingDetails');
            if (copyButton) {
                copyButton.addEventListener('click', function() {
                    try {
                        const bookingDetails =
                            `๐ *ุชูุงุตูู ุงูุญุฌุฒ ููุนููู:* {{ $booking->client_name }}\n\n` +
                            Array.from(document.querySelectorAll('.table tbody tr'))
                            .map(row => {
                                const cells = row.querySelectorAll('td'); // ุงุณุชุฎุฑุงุฌ ุงูุฃุนูุฏุฉ
                                const number = cells[0]?.innerText.trim(); // ุงูุฑูู
                                const title = cells[1]?.innerText.trim(); // ุงูุนููุงู
                                const value = cells[2]?.innerText.trim(); // ุงููููุฉ

                                // ุฅุถุงูุฉ ุงูุฅูููุฌู ุงูููุงุณุจุฉ ุจูุงุกู ุนูู ุงูุนููุงู
                                let emoji = '';
                                if (title.includes('ุงุณู ุงูุดุฑูุฉ')) emoji = '๐ข';
                                else if (title.includes('ุฌูุฉ ุงูุญุฌุฒ')) emoji = '๐';
                                else if (title.includes('ุงุณู ุงูููุฏู')) emoji = '๐จ';
                                else if (title.includes('ููุน ุงูุบุฑูุฉ')) emoji = '๐๏ธ';
                                else if (title.includes('ุนุฏุฏ ุงูุบุฑู')) emoji = '๐ช';
                                else if (title.includes('ุชุงุฑูุฎ ุงูุฏุฎูู') || title.includes(
                                        'ุชุงุฑูุฎ ุงูุฎุฑูุฌ')) emoji = '๐';
                                else if (title.includes('ุนุฏุฏ ุงูููุงูู')) emoji = '๐';
                                else if (title.includes('ุงูุฃูุงู ุงููุชุจููุฉ ุญุชู ุงูุฎุฑูุฌ')) emoji = 'โณ';
                                else if (title.includes('ุงูุณุนุฑ ูู ุงูููุฏู')) emoji = '๐ต';
                                else if (title.includes('ุงููุณุชุญู ููููุฏู')) emoji =
                                    '๐ถ'; // ุฅุถุงูุฉ ุฅูููุฌู ูููุณุชุญู ููููุฏู
                                else if (title.includes('ุงููุจูุบ ุงููุฏููุน ููููุฏู')) emoji = '๐ณ';
                                else if (title.includes('ุงูุจุงูู ููููุฏู')) emoji = '๐ธ';
                                else if (title.includes('ุณุนุฑ ุงูุจูุน ููุดุฑูุฉ')) emoji = '๐ต';
                                else if (title.includes('ุงููุจูุบ ุงููุณุชุญู ูู ุงูุดุฑูุฉ')) emoji = '๐ฐ';
                                else if (title.includes('ุงููุจูุบ ุงููุฏููุน ูู ุงูุดุฑูุฉ')) emoji = '๐ผ';
                                else if (title.includes('ุงูุจุงูู ูู ุงูุดุฑูุฉ')) emoji = 'โ๏ธ';
                                else if (title.includes('ุงูููุธู ุงููุณุคูู')) emoji = '๐ค';
                                else if (title.includes('ุงูููุงุญุธุงุช')) emoji = '๐';

                                return `${emoji} ${number}. ${title}: ${value}`; // ุฏูุฌ ุงููุตูุต ูุน ุงูุฅูููุฌู
                            })
                            .join('\n'); // ูุตู ุงููุตูุต ุจุฎุท ุฌุฏูุฏ

                        navigator.clipboard.writeText(bookingDetails).then(() => {
                            showAlert('ุชู ูุณุฎ ุจูุงูุงุช ุงูุญุฌุฒ ุจูุฌุงุญ!', 'success');
                        }).catch(err => {
                            console.error('ุฎุทุฃ ุฃุซูุงุก ูุณุฎ ุงูุจูุงูุงุช:', err);
                            showAlert('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ูุณุฎ ุงูุจูุงูุงุช.', 'danger');
                        });
                    } catch (error) {
                        console.error('ุฎุทุฃ ุบูุฑ ูุชููุน:', error);
                        showAlert('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ูุณุฎ ุงูุจูุงูุงุช.', 'danger');
                    }
                });
            }

            // ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ "calculate-total"
            document.getElementById('calculate-total').addEventListener('click', function() {
                let totalDueFromCompany = 0;
                let totalDueToHotel = 0;
                let profitPerNight = 0;
                let profitSoFar = 0;
                let totalProfit = 0;

                // ุญุณุงุจ ุนุฏุฏ ุงูููุงูู ุงูุชู ูุถุงูุง ุงูุนููู ุญุชู ุงูุขู
                let checkInDate = new Date("{{ $booking->check_in }}");
                let checkOutDate = new Date("{{ $booking->check_out }}");
                let today = new Date();

                let nightsStayed = Math.min(
                    Math.max(0, Math.ceil((today - checkInDate) / (1000 * 60 * 60 * 24))),
                    {{ $booking->days }}
                );

                // ุญุณุงุจ ุนุฏุฏ ุงูููุงูู ุงูุฅุฌูุงููุฉ
                let totalNights = Math.ceil((checkOutDate - checkInDate) / (1000 * 60 * 60 * 24));

                // ุญุณุงุจ ุงูุฅุฌูุงูู ูู ุงูุดุฑูุฉ ูุงูููุฏู
                totalDueFromCompany = nightsStayed * {{ $booking->rooms }} * {{ $booking->sale_price }};
                totalDueToHotel = nightsStayed * {{ $booking->rooms }} * {{ $booking->cost_price }};

                // ุชุญุฏูุซ ุตู "ุงููุณุชุญู ููููุฏู" ุจุงููููุฉ ุงููุญุณูุจุฉ
                document.getElementById('hotel-due-value').innerText = totalDueToHotel + ' ุฑูุงู';

                // ุญุณุงุจ ุงูููุณุจ
                profitPerNight = ({{ $booking->sale_price }} - {{ $booking->cost_price }}) *
                    {{ $booking->rooms }};
                profitSoFar = profitPerNight * nightsStayed;
                totalProfit = profitPerNight * totalNights;

                // ุงููุจุงูุบ ุงููุฏููุนุฉ
                let amountPaidByCompany = {{ $booking->amount_paid_by_company }};
                let amountPaidToHotel = {{ $booking->amount_paid_to_hotel }};

                // ุญุณุงุจ ุงููุจุงูุบ ุงููุชุจููุฉ
                let remainingFromCompany = totalDueFromCompany - amountPaidByCompany;
                let remainingToHotel = totalDueToHotel - amountPaidToHotel;

                // ุจูุงุก ุฑุณุงูุฉ ุงูุชูุจูู ุจุงูุชูุงุตูู ุจูุง ูู ุฐูู ุงููุณุชุญู ููููุฏู
                let alertMessage = `๐ฒ ุงูุฅุฌูุงูู ุญุชู ุงูุขู: ๐ฒ
            
ูุง ูู ูู ุงูุดุฑูุฉ: ${nightsStayed} ูููุฉ * {{ $booking->rooms }} ุบุฑูุฉ * {{ $booking->sale_price }} ุณุนุฑ ุงููููุฉ = ${totalDueFromCompany} ุฑูุงู
ูุง ุนููู ููููุฏู: ${nightsStayed} ูููุฉ * {{ $booking->rooms }} ุบุฑูุฉ * {{ $booking->cost_price }} ุณุนุฑ ุงูููุฏู = ${totalDueToHotel} ุฑูุงู

๐ฐ ุงูููุณุจ:
- ุงูููุณุจ ููู ูููุฉ: ${profitPerNight} ุฑูุงู
- ุงูููุณุจ ุญุชู ุงูุขู: ${profitSoFar} ุฑูุงู
- ุงูููุณุจ ุงูุฅุฌูุงูู: ${totalProfit} ุฑูุงู

๐ณ ุงููุจุงูุบ ุงููุฏููุนุฉ:
- ุงููุฏููุน ูู ุงูุดุฑูุฉ: ${amountPaidByCompany} ุฑูุงู
- ุงููุฏููุน ููููุฏู: ${amountPaidToHotel} ุฑูุงู

โ๏ธ ุงููุจุงูุบ ุงููุชุจููุฉ:
- ุงููุชุจูู ูู ุงูุดุฑูุฉ: ${remainingFromCompany} ุฑูุงู
- ุงููุชุจูู ููููุฏู: ${remainingToHotel} ุฑูุงู`;

                showAlert(alertMessage, 'info');
            });

            function showAlert(message, type) {
                const alertBox = document.createElement('div');
                alertBox.className = `alert alert-${type}`;
                alertBox.innerText = message;

                // ุฅุถุงูุฉ ุงูุชูุจูู ุฅูู ุฃุนูู ุงูุตูุญุฉ
                document.body.appendChild(alertBox);

                // ุฅุฒุงูุฉ ุงูุชูุจูู ุจุนุฏ 5 ุซูุงูู
                setTimeout(() => {
                    alertBox.remove();
                }, 5000);
            }
        });
    </script>
@endsection
